<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Geolocalización</title>
    <link rel="stylesheet" href="css/main.css">
</head>

<body>
    <div class="load" id="load">
        <b>15410596 - Juan Daniel Martinez Navarro</b>
        <p>Obteniendo ubicación</p>
    </div>
    
    <div class="route" id="route" hidden>
        <form action="">
           <label for="modo">Modo de viaje:</label>
            <select name="modo" id="modo">
                <option value="auto">En auto</option>
                <option value="caminando">Caminando</option>
                <option value="bici">En bicicleta</option>
                <option value="transporte">En transporte público</option>
            </select>
            <label for="lugar">Destino:</label>
            <select name="lugar" id="lugar">
                <option value="museo">Museo de Villa</option>
                <option value="palacio">Palacio Alvarado</option>
                <option value="mina">Mina La Prieta</option>
                <option value="foro">Foro Villista</option>
                <option value="puerta">Puerta del Tiempo</option>
                <option value="estadio">Gran Estadio Parral</option>
                <option value="olimpico">Estadio Olímpico Parral</option>
            </select>
            <button id="calcular" class="calcular">Calcular Ruta</button>
        </form>
    </div>
    
    <div id="map"></div>
    <script>
        // Inicializar mapa centrado en Parral
        function initMap() {
            var load = document.getElementById('load');
            var route = document.getElementById('route');
            // Si la geolocalización está habilitada
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(function(position) {
                    var pos = {
                        lat: position.coords.latitude,
                        lng: position.coords.longitude
                    };

                    var map = new google.maps.Map(document.getElementById('map'), {
                        center: {
                            lat: 26.933071257230367,
                            lng: -105.66370751376643
                        },
                        zoom: 15
                    });

                    // Ocultar contenedor de carga y mostrar el de trazar ruta
                    load.style.display = 'none';
                    route.style.display = 'block';
                    
                    // Centrar mapa en posicion
                    map.setCenter(pos);

                    //Añadiendo marcador en posicion
                    var marker = new google.maps.Marker({
                        position: pos,
                        map: map
                    });
                }, mostrarErrores);
            } else {
                // Navegador no soporta geolocalizacion
                alert("Tu navegador no sporta la geolocalización");
            }
        }

        // Mostrar alerts de acuerdo al error
        function mostrarErrores(error) {
            switch (error.code) {
                case error.PERMISSION_DENIED:
                    alert('Permiso denegado por el usuario');
                    break;
                case error.POSITION_UNAVAILABLE:
                    alert('Posición no disponible');
                    break;
                case error.TIMEOUT:
                    alert('Tiempo de espera agotado');
                    break;
                default:
                    alert('Error de Geolocalización desconocido :' + error.code);
            }
        }
    </script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC75jJrrQe0xAlMfnJIyCqKQBbDdRfcSV8&callback=initMap" async defer></script>
</body>
</html>